<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  
  <title>UCify - Official BGMI Partner</title>
  <meta name="title" content="UCify - Official BGMI Partner | Fast & Secure UC Delivery">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;800&family=Rajdhani:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --primary: #FFB800; /* UC Gold */
      --primary-dim: #996e00;
      --accent: #00E0FF; /* Tech Cyan */
      --bg-dark: #050507;
      --bg-panel: #121216;
      --surface: rgba(255, 255, 255, 0.03);
      --surface-border: rgba(255, 255, 255, 0.08);
      --text-main: #ffffff;
      --text-muted: #8f90a6;
      --success: #00ff9d;
      --error: #ff4757;
      
      --font-display: 'Rajdhani', sans-serif;
      --font-body: 'Outfit', sans-serif;
      
      --radius-lg: 24px;
      --radius-md: 16px;
      --radius-sm: 8px;
    }

    /* --- BASE RESET & CROSS BROWSER FIXES --- */
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    
    body {
      font-family: var(--font-body);
      background-color: var(--bg-dark);
      color: var(--text-main);
      min-height: 100vh;
      overflow-x: hidden;
      display: flex;
      justify-content: center;
      /* Remove background image from here to fix mobile scroll jump */
    }

    /* Fixed Background Layer - Solves Browser Inconsistencies */
    .bg-fixed {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      z-index: -1;
      background-color: var(--bg-dark);
      background-image: 
        radial-gradient(circle at 10% 20%, rgba(255, 184, 0, 0.03) 0%, transparent 40%),
        radial-gradient(circle at 90% 80%, rgba(0, 224, 255, 0.03) 0%, transparent 40%),
        url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.02'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    }

    /* --- LAYOUT CONTAINER --- */
    .container {
      width: 100%;
      max-width: 480px;
      padding: 20px;
      position: relative;
      z-index: 2;
      padding-bottom: 50px;
    }

    /* --- HEADER CARD --- */
    .top-card {
      background: rgba(18, 18, 22, 0.6);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border: 1px solid var(--surface-border);
      border-radius: var(--radius-lg);
      padding: 30px 20px;
      text-align: center;
      margin-bottom: 25px;
      position: relative;
      overflow: hidden;
      box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
    }

    /* Glow effect */
    .top-card::before {
      content: '';
      position: absolute;
      top: -50%; left: 50%;
      transform: translateX(-50%);
      width: 80%; height: 100%;
      background: radial-gradient(circle, rgba(255,184,0,0.15), transparent 70%);
      pointer-events: none;
    }

    .logo-img {
      max-width: 180px;
      height: auto;
      filter: drop-shadow(0 0 15px rgba(255,184,0,0.3));
    }

    .tagline {
      color: var(--text-muted);
      font-size: 13px;
      margin-top: 8px;
      letter-spacing: 0.5px;
    }

    /* --- PARTNER BADGE (UPDATED) --- */
    .partner-block { margin-top: 15px; }
    .partner-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: rgba(255, 184, 0, 0.1);
      border: 1px solid rgba(255, 184, 0, 0.3);
      color: var(--primary);
      padding: 6px 16px;
      border-radius: 50px;
      font-family: var(--font-display);
      font-weight: 700;
      text-transform: uppercase;
      font-size: 12px;
      letter-spacing: 1px;
    }

    .trust-strip {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-top: 15px;
    }

    .trust-pill {
      font-size: 11px;
      color: var(--text-muted);
      background: var(--surface);
      padding: 6px 12px;
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      gap: 6px;
      border: 1px solid transparent;
    }

    .live-stats {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 15px;
    }
    
    .stat-badge {
      font-size: 12px;
      font-weight: 600;
      color: #fff;
      background: linear-gradient(90deg, rgba(255,255,255,0.05), transparent);
      padding: 8px 12px;
      border-radius: var(--radius-sm);
      border-left: 3px solid var(--accent);
    }
    .stat-number { color: var(--accent); font-weight: 800; font-family: var(--font-display); }

    /* --- PROGRESS BAR --- */
    .progress-wrap { margin-bottom: 25px; padding: 0 10px; }
    .progress-container {
      display: flex;
      justify-content: space-between;
      position: relative;
    }
    .progress-container::before {
      content: '';
      position: absolute;
      top: 50%; left: 0;
      width: 100%; height: 2px;
      background: var(--surface-border);
      transform: translateY(-50%);
      z-index: 0;
    }

    .progress-step {
      width: 32px; height: 32px;
      background: var(--bg-panel);
      border: 2px solid var(--surface-border);
      border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-family: var(--font-display);
      font-weight: 700; font-size: 14px;
      color: var(--text-muted);
      position: relative; z-index: 1;
      transition: all 0.3s ease;
    }

    .progress-step.active {
      border-color: var(--primary);
      color: var(--primary);
      box-shadow: 0 0 15px rgba(255,184,0,0.4);
      background: var(--bg-dark);
      transform: scale(1.1);
    }
    .progress-step.completed {
      background: var(--primary);
      border-color: var(--primary);
      color: #000;
    }
    .progress-line { display: none; } 

    /* --- STEP CONTENT --- */
    .step { display: none; animation: fadeInUp 0.5s cubic-bezier(0.16, 1, 0.3, 1); }
    .step.active { display: block; }
    
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .step-content {
      background: var(--bg-panel);
      border: 1px solid var(--surface-border);
      border-radius: var(--radius-lg);
      padding: 24px;
      position: relative;
      overflow: hidden;
    }

    .step-content::after {
      content: '';
      position: absolute; top: 0; right: 0;
      width: 0; height: 0;
      border-style: solid;
      border-width: 0 40px 40px 0;
      border-color: transparent rgba(255,184,0,0.1) transparent transparent;
    }

    .step-title {
      font-family: var(--font-display);
      font-size: 26px;
      text-transform: uppercase;
      margin-bottom: 5px;
      background: linear-gradient(to right, #fff, #aaa);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    
    .subnote {
      color: var(--text-muted);
      font-size: 14px;
      margin-bottom: 25px;
    }

    /* --- INPUT FIELDS (Cross Browser Fixed) --- */
    .form-group { margin-bottom: 20px; position: relative; }
    .form-label {
      display: block;
      font-size: 12px; font-weight: 600;
      text-transform: uppercase;
      color: var(--text-muted);
      margin-bottom: 8px;
      letter-spacing: 1px;
    }
    
    .form-input-wrapper { position: relative; }
    
    .form-input {
      width: 100%;
      background: rgba(0,0,0,0.3);
      border: 1px solid var(--surface-border);
      color: #fff;
      padding: 16px;
      padding-right: 40px;
      border-radius: var(--radius-md);
      font-family: var(--font-display);
      font-size: 18px;
      letter-spacing: 1px;
      transition: all 0.3s ease;
      /* Remove Default iOS Styles */
      -webkit-appearance: none;
      appearance: none;
      box-shadow: none;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 2px rgba(255,184,0,0.1);
      background: rgba(0,0,0,0.5);
    }
    
    .input-icon {
      position: absolute; right: 15px; top: 50%;
      transform: translateY(-50%);
      color: var(--success);
      font-size: 18px;
      opacity: 0; transition: 0.3s;
    }
    .input-icon.check { opacity: 1; }
    
    .error-message {
      color: var(--error);
      font-size: 12px;
      margin-top: 6px;
      display: none;
    }
    .error-message.show { display: block; animation: shake 0.4s ease; }

    /* --- UC PACKS GRID --- */
    .packs-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin-bottom: 24px;
    }

    .pack-card {
      background: linear-gradient(145deg, rgba(255,255,255,0.03) 0%, rgba(0,0,0,0.2) 100%);
      border: 1px solid var(--surface-border);
      border-radius: var(--radius-md);
      padding: 15px;
      text-align: center;
      cursor: pointer;
      position: relative;
      transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
      overflow: hidden;
    }

    .pack-card:hover:not(.purchased) {
      transform: translateY(-3px);
      border-color: rgba(255,184,0,0.4);
      box-shadow: 0 10px 20px rgba(0,0,0,0.3);
    }

    .pack-card.selected {
      background: rgba(255, 184, 0, 0.1);
      border: 1px solid var(--primary);
      box-shadow: 0 0 20px rgba(255,184,0,0.15);
    }

    .pack-uc {
      display: flex;
      align-items: center; justify-content: center; gap: 8px;
      font-family: var(--font-display);
      font-size: 20px; font-weight: 700; color: #fff;
    }
    .uc-icon { width: 24px; height: 24px; }

    .pack-price {
      margin-top: 6px;
      color: var(--text-muted);
      font-size: 14px; font-weight: 600;
    }
    .pack-card.selected .pack-price { color: var(--primary); }
    
    .check-mark {
      position: absolute; top: 0; right: 0;
      background: var(--primary);
      color: #000;
      width: 24px; height: 24px;
      border-bottom-left-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      font-size: 12px;
    }

    /* Completely hide purchased packs */
    .pack-card.purchased {
      display: none !important;
    }

    /* --- BUTTONS --- */
    .btn-row { display: flex; gap: 10px; margin-top: 20px; }
    
    .btn {
      width: 100%;
      padding: 16px;
      border: none;
      border-radius: var(--radius-md);
      font-family: var(--font-display);
      font-weight: 700;
      font-size: 16px;
      text-transform: uppercase;
      cursor: pointer;
      letter-spacing: 1px;
      transition: all 0.2s;
      position: relative;
      overflow: hidden;
      -webkit-appearance: none; /* Cross browser fix */
    }

    .btn-primary {
      background: var(--primary);
      color: #000;
      box-shadow: 0 4px 15px rgba(255,184,0,0.3);
    }
    
    .btn-primary:hover:not(:disabled) {
      background: #ffc42e;
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(255,184,0,0.4);
    }
    
    .btn-primary:disabled {
      background: #333;
      color: #666;
      box-shadow: none;
      cursor: not-allowed;
    }

    .btn-secondary {
      background: transparent;
      border: 1px solid var(--surface-border);
      color: var(--text-muted);
    }
    .btn-secondary:hover {
      border-color: #fff;
      color: #fff;
    }

    /* --- PAYMENT SECTION (STEP 3) --- */
    .payment-section { text-align: center; }
    
    .qr-card {
      background: #000;
      padding: 20px;
      border-radius: var(--radius-md);
      border: 1px solid var(--surface-border);
      margin: 15px 0;
      transition: 0.3s;
    }

    .qr-card.dimmed {
      opacity: 0.3;
      pointer-events: none;
      filter: grayscale(1);
    }
    
    .qr-box {
      width: 200px; height: 200px;
      margin: 0 auto;
      background: #fff;
      padding: 10px;
      border-radius: 10px;
    }
    
    .qr-skeleton {
      width: 100%; height: 100%;
      background: #222;
      animation: pulse 1.5s infinite;
    }

    .qr-timer {
      color: var(--error);
      font-family: var(--font-display);
      font-weight: 600;
      margin: 10px 0;
    }

    .upi-id {
      display: inline-block;
      background: #1a1a1a;
      padding: 8px 12px;
      border-radius: 6px;
      border: 1px dashed #444;
      color: var(--primary);
      font-family: monospace;
      margin: 5px 0;
    }

    .copy-btn {
      background: none;
      border: none;
      color: var(--text-muted);
      cursor: pointer;
      font-size: 14px;
      margin-left: 8px;
    }
    .copy-btn:hover { color: #fff; }

    /* Limit Warning */
    .limit-warning {
      background: rgba(255, 71, 87, 0.1);
      border: 1px solid var(--error);
      color: var(--error);
      padding: 12px;
      border-radius: var(--radius-sm);
      font-size: 13px;
      margin-bottom: 15px;
      display: none;
      text-align: left;
    }

    /* File Upload */
    .file-upload-area {
      border: 2px dashed var(--surface-border);
      background: rgba(0,0,0,0.2);
      border-radius: var(--radius-md);
      padding: 30px;
      text-align: center;
      transition: 0.3s;
      cursor: pointer;
    }
    .file-upload-area:hover, .file-upload-area.dragover {
      border-color: var(--primary);
      background: rgba(255,184,0,0.05);
    }
    
    #screenshotPreview {
      max-width: 100%;
      margin-top: 15px;
      border-radius: 8px;
      display: none;
      border: 1px solid var(--surface-border);
    }
    
    .upload-progress {
      height: 3px;
      background: var(--primary);
      width: 0%;
      margin-top: 10px;
      transition: width 0.1s;
    }

    /* --- SUCCESS (STEP 4) --- */
    .success-screen { text-align: center; }
    .success-icon { 
      font-size: 60px; 
      color: var(--success); 
      margin-bottom: 20px;
      text-shadow: 0 0 20px rgba(0,255,157,0.4);
    }
    
    .success-title {
      font-family: var(--font-display);
      font-size: 28px;
      color: #fff;
      margin-bottom: 20px;
    }

    /* Game Loader Bar */
    .game-loader-wrap { margin: 30px 0; }
    .game-bar-bg {
      height: 10px;
      background: #222;
      border-radius: 5px;
      overflow: hidden;
      margin-bottom: 10px;
    }
    .game-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--primary), #ff6b00);
      width: 0%;
      box-shadow: 0 0 10px rgba(255,184,0,0.5);
      border-radius: 5px;
      transition: width 1s linear;
    }
    .timer-text { font-family: monospace; color: var(--primary); font-size: 16px; }
    
    .receipt-box {
      background: #111;
      border: 1px solid #222;
      padding: 20px;
      border-radius: var(--radius-md);
      text-align: left;
      margin-top: 20px;
      font-family: monospace;
    }
    .receipt-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      border-bottom: 1px dashed #333;
      padding-bottom: 8px;
    }
    .receipt-label { color: #666; }
    .receipt-value { color: #fff; font-weight: 600; }

    /* --- TOAST & SOCIAL PROOF --- */
    .toast {
      position: fixed; top: 20px; left: 50%; transform: translateX(-50%) translateY(-100px);
      background: #1a1a1a;
      border: 1px solid var(--success);
      padding: 12px 24px;
      border-radius: 50px;
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 100;
      transition: 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    }
    .toast.show { transform: translateX(-50%) translateY(0); }
    .toast i { color: var(--success); }

    .social-proof {
      position: fixed; bottom: 20px; left: 20px;
      background: rgba(10,10,10,0.8);
      backdrop-filter: blur(10px);
      border: 1px solid var(--surface-border);
      padding: 10px 15px;
      border-radius: 50px;
      display: none;
      align-items: center;
      gap: 10px;
      z-index: 99;
      box-shadow: 0 10px 20px rgba(0,0,0,0.5);
      animation: slideInLeft 0.5s ease;
    }
    @keyframes slideInLeft { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
    
    .social-proof-avatar {
      width: 30px; height: 30px;
      background: var(--primary);
      border-radius: 50%;
      color: #000;
      display: flex; align-items: center; justify-content: center;
      font-weight: 700;
      font-size: 14px;
    }
    .social-proof-text { font-size: 12px; color: #ccc; }
    .social-proof-uc { color: var(--primary); font-weight: 700; }

    /* Particles CSS (Replacing Heavy JS) */
    .floating-particles { position: fixed; inset: 0; pointer-events: none; z-index: 0; }
    .particle {
      position: absolute;
      color: var(--primary);
      opacity: 0.1;
      font-size: 10px;
      animation: floatUp linear infinite;
    }
    @keyframes floatUp {
      0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
      20% { opacity: 0.2; }
      80% { opacity: 0.2; }
      100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; }
    }

    .night-msg {
       display: none;
       background: rgba(255, 184, 0, 0.05);
       border: 1px solid var(--primary-dim);
       color: var(--primary);
       padding: 15px;
       border-radius: var(--radius-md);
       font-size: 13px;
       margin-top: 15px;
    }

    .final-success-msg { display: none; color: var(--success); margin-top: 10px; font-weight: 600; }
    
    .confetti { position: fixed; width: 8px; height: 8px; z-index: 200; pointer-events: none; }

  </style>
</head>

<body>
  <div class="bg-fixed"></div> <!-- Browser Fix Background -->
  
  <audio id="bgmAudio" src="bgm.mp3" loop></audio>
  <div class="floating-particles" id="floatingParticles"></div>

  <div class="social-proof" id="socialProof">
    <div class="social-proof-avatar" id="socialAvatar">A</div>
    <div class="social-proof-text">
      <div id="socialName" style="font-weight: 600; color: #fff;">Player</div>
      purchased <span class="social-proof-uc" id="socialUC">660 UC</span>
    </div>
  </div>

  <div class="toast" id="toast">
    <i class="fas fa-check-circle"></i>
    <span class="toast-text" id="toastText">Copied!</span>
  </div>

  <div class="container">
    
    <div class="top-card">
      <div class="header">
        <img src="ucify.webp" alt="UCify Logo" class="logo-img">
        <p class="tagline">Official BGMI Partner • Lightning-fast delivery</p>

        <div class="partner-block">
          <!-- Removed Icon and changed text as requested -->
          <div class="partner-badge">Official Partner</div>
        </div>

        <div class="trust-strip">
          <div class="trust-pill"><i class="fa-solid fa-lock"></i> Secure</div>
          <div class="trust-pill"><i class="fa-solid fa-bolt"></i> Instant</div>
          <div class="trust-pill"><i class="fa-solid fa-headset"></i> 24/7</div>
        </div>

        <div class="live-stats">
          <div class="stat-badge">
            <i class="fa-solid fa-earth-asia" style="color: var(--accent);"></i>
            <span id="liveOrders" class="stat-number">1425</span> Orders Today
          </div>
        </div>
      </div>
    </div>

    <div class="progress-wrap">
      <div class="progress-container">
        <div class="progress-step active" data-step="1">1</div>
        <div class="progress-line" id="line1"></div> <div class="progress-step" data-step="2">2</div>
        <div class="progress-line" id="line2"></div>
        <div class="progress-step" data-step="3">3</div>
        <div class="progress-line" id="line3"></div>
        <div class="progress-step" data-step="4"><i class="fa-solid fa-check"></i></div>
      </div>
    </div>

    <div id="step1" class="step active">
      <div class="step-content">
        <h2 class="step-title">Player Details</h2>
        <p class="subnote">Enter your BGMI ID to verify account</p>

        <div class="form-group">
          <label class="form-label">BGMI Character ID (UID)</label>
          <div class="form-input-wrapper">
            <!-- Removed Placeholder -->
            <input type="tel" class="form-input" id="uid" maxlength="12" inputmode="numeric">
            <i class="input-icon" id="uidIcon"></i>
          </div>
          <div class="error-message" id="uidError">Invalid UID Format</div>
        </div>

        <div class="form-group">
          <label class="form-label">In-Game Name (IGN)</label>
          <div class="form-input-wrapper">
             <!-- Removed Placeholder -->
            <input type="text" class="form-input" id="ign" maxlength="20">
            <i class="input-icon" id="ignIcon"></i>
          </div>
          <div class="error-message" id="ignError">Name Required</div>
        </div>

        <div class="btn-row">
          <button type="button" class="btn btn-primary" id="next1" disabled>Verify & Continue <i class="fa-solid fa-arrow-right"></i></button>
        </div>
      </div>
    </div>

    <div id="step2" class="step">
      <div class="step-content">
        <h2 class="step-title">Select Loadout</h2>
        <p class="subnote">Top up for <span id="displayUid" style="color:var(--primary);">--</span></p>

        <div class="packs-grid" id="packsGrid">
          <!-- Changed price to 45 -->
          <div class="pack-card" data-uc="60" data-price="45">
            <div class="pack-uc"><img src="uc-logo.webp" class="uc-icon"> 60</div>
            <div class="pack-price">₹45</div>
          </div>
          
          <!-- Added new pack: 325 UC for 180 -->
          <div class="pack-card" data-uc="325" data-price="180">
            <div class="pack-uc"><img src="uc-logo.webp" class="uc-icon"> 325</div>
            <div class="pack-price">₹180</div>
          </div>

          <div class="pack-card" data-uc="660" data-price="375">
            <div class="pack-uc"><img src="uc-logo.webp" class="uc-icon"> 660</div>
            <div class="pack-price">₹375</div>
          </div>
          <div class="pack-card" data-uc="1800" data-price="950">
            <div class="pack-uc"><img src="uc-logo.webp" class="uc-icon"> 1800</div>
            <div class="pack-price">₹950</div>
          </div>
          <div class="pack-card" data-uc="3850" data-price="1710">
            <div class="pack-uc"><img src="uc-logo.webp" class="uc-icon"> 3850</div>
            <div class="pack-price">₹1710</div>
          </div>
          <div class="pack-card" data-uc="8100" data-price="3375">
            <div class="pack-uc"><img src="uc-logo.webp" class="uc-icon"> 8100</div>
            <div class="pack-price">₹3375</div>
          </div>
          <!-- Removed 16200 UC Pack -->
        </div>

        <div class="btn-row">
           <button type="button" class="btn btn-secondary" id="backToDetails">Back</button>
           <button type="button" class="btn btn-primary" id="next2" disabled>Checkout</button>
        </div>
      </div>
    </div>

    <div id="step3" class="step">
      <div class="step-content">
        <h2 class="step-title">Payment Gateway</h2>
        <p class="subnote">Complete transaction to trigger transfer</p>

        <div class="payment-section">
          <div style="font-size: 14px; margin-bottom: 10px; color: var(--text-muted);">TOTAL PAYABLE</div>
          <div style="font-size: 32px; font-weight: 800; color: var(--primary); font-family: var(--font-display); margin-bottom: 20px;">
            <span id="paymentAmount">₹0</span>
          </div>
          
          <!-- Warning for high amount -->
          <div class="limit-warning" id="limitWarning">
             <i class="fa-solid fa-triangle-exclamation"></i> 
             <strong>Bank Limit:</strong> Please use "Copy UPI ID" and pay manually for amounts over ₹2000. QR scanning may fail.
          </div>

          <div class="qr-card" id="qrCard">
            <div class="qr-box">
               <div id="qrLoader" class="qr-skeleton"></div>
               <img id="staticQrImage" src="" alt="Scan QR" style="width:100%; height:100%; object-fit:contain; display:none;">
            </div>
            
            <div class="qr-timer" id="qrTimer" style="display:none;">
              <i class="fa-regular fa-clock"></i> <span id="timerDisplay">15:00</span>
            </div>

            <div style="margin-top: 15px;">
              <div style="font-size: 11px; color: #666; margin-bottom: 5px;">UPI ID / VPA</div>
              <span id="upiIdText" class="upi-id">--</span>
              <button type="button" class="copy-btn" id="copyUpiBtn"><i class="fa-solid fa-copy"></i></button>
            </div>
          </div>

          <div style="text-align: left; font-size: 12px; color: #888; background: rgba(0,0,0,0.3); padding: 10px; border-radius: 8px;">
            <i class="fa-solid fa-circle-info" style="color: var(--accent);"></i> 
            Scan the QR code and pay exactly the amount shown. Take a screenshot of the success screen.
          </div>
        </div>

        <!-- Replaced Netlify form with standard form for Web3Forms/AJAX -->
        <form id="orderForm" style="margin-top: 20px;">
          <!-- IMPORTANT: You must generate a key at web3forms.com and paste it below -->
          <!-- We are using JavaScript to submit this, but this input is here just in case -->
          <input type="hidden" name="access_key" value="YOUR_ACCESS_KEY_HERE"> 
          
          <input type="hidden" name="subject" value="New UC Order">
          
          <div class="file-upload-area" id="uploadArea">
            <i class="fas fa-cloud-arrow-up" id="uploadIcon" style="font-size: 32px; color: var(--text-muted); margin-bottom: 10px;"></i>
            <i class="fas fa-check-circle upload-success-icon" id="uploadSuccessIcon" style="display:none; font-size: 40px; color: var(--success);"></i>
            <div id="uploadText" style="font-weight: 600; font-size: 14px;">Upload Payment Screenshot</div>
            <div class="hint" id="uploadHint" style="font-size: 11px; color: #666;">Tap to browse or drag file here</div>
            
            <input type="file" id="screenshot" accept="image/*" style="display:none;" required>
            <img id="screenshotPreview">
            <div class="upload-progress" id="uploadProgress"></div>
          </div>

          <div class="btn-row">
            <button type="button" class="btn btn-secondary" id="back3">Back</button>
            <button type="submit" class="btn btn-primary" id="submitBtn">Confirm Order</button>
          </div>
        </form>
      </div>
    </div>

    <div id="step4" class="step">
      <div class="step-content success-screen">
        <div class="success-icon"><i class="fa-regular fa-circle-check"></i></div>
        <h2 class="success-title">Order Confirmed</h2>
        
        <div class="game-loader-wrap" id="gameLoaderWrap">
            <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                <span class="delivery-msg" id="deliveryMsg">Connecting to Servers...</span>
                <span class="timer-text" id="deliveryTimer">07:00</span>
            </div>
            <div class="game-bar-bg">
                <div class="game-bar-fill" id="gameBarFill"></div>
            </div>
        </div>

        <div class="night-msg" id="nightMessage">
             <i class="fas fa-moon" style="margin-bottom: 8px; font-size: 18px;"></i><br>
             <strong>Night Mode Active</strong><br>
             Instant delivery paused. UC will be credited after 9:00 AM.
        </div>

        <div class="final-success-msg" id="finalSuccessMsg">
             UC Transfer Complete.
        </div>

        <div class="receipt-box">
          <div style="color: var(--primary); margin-bottom: 15px; font-weight: 700; display:flex; justify-content:space-between;">
             <span>RECEIPT</span>
             <span><span id="orderIdText" style="color: #fff; cursor: pointer;" onclick="copyOrderId()">--</span> <i class="fa-solid fa-copy" style="font-size:12px; margin-left:5px;"></i></span>
          </div>
          <div class="receipt-row"><span class="receipt-label">Pack</span><span class="receipt-value" id="receipt-pack">--</span></div>
          <div class="receipt-row"><span class="receipt-label">Amount</span><span class="receipt-value" id="receipt-amount">--</span></div>
          <div class="receipt-row"><span class="receipt-label">UID</span><span class="receipt-value" id="receipt-uid">--</span></div>
          <div class="receipt-row"><span class="receipt-label">IGN</span><span class="receipt-value" id="receipt-ign">--</span></div>
          <div class="receipt-row"><span class="receipt-label">Time</span><span class="receipt-value" id="receipt-time">--</span></div>
        </div>

        <div id="newOrderBtnWrap" style="margin-top: 20px;">
          <button type="button" class="btn btn-primary" onclick="location.reload()" id="newOrderBtn" style="display:none;">Place Another Order</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // --- IMPORTANT CONFIGURATION ---
    
    // 1. WEB3FORMS KEY (For Free Emails):
    // Go to https://web3forms.com/, enter your email, and they will send you an Access Key.
    // Replace the string below with your key.
    const WEB3FORMS_ACCESS_KEY = "YOUR_ACCESS_KEY_HERE"; 

    // 2. GOOGLE SHEETS URL (For UID History):
    const APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbxZmmaWlqrx9ydYVfO3XkZKh25Oxa_k0XiLNBPbEVEBOwZTlE2qPxF6OEoU-I9oJzLj/exec"; 

    const UPIVPA = "ucify@ptaxis";
    
    // --- LOGIC STARTS ---
    let currentStep = 1;
    let selectedPack = null;
    let screenshotFile = null;
    let orderId = null;
    let qrTimer = null;
    let timerSeconds = 900;
    let currentUid = "";
    let currentIgn = "";

    // BGM Setup
    const bgm = document.getElementById('bgmAudio');
    bgm.volume = 0.3; 
    function initAudio() {
        if(bgm.paused) {
            bgm.play().catch(e => console.log("Audio waiting for interaction"));
        }
    }
    document.body.addEventListener('click', initAudio, { once: true });
    document.body.addEventListener('touchstart', initAudio, { once: true });

    document.addEventListener("visibilitychange", function() {
        if (document.hidden) { bgm.pause(); } else { bgm.play().catch(e => console.log("Waiting")); }
    });

    // Particles
    function initParticles(){
      const container = document.getElementById('floatingParticles');
      for(let i = 0; i < 15; i++){
        const particle = document.createElement('div');
        particle.className = 'particle';
        particle.innerHTML = '✦';
        particle.style.left = Math.random() * 100 + '%';
        particle.style.top = Math.random() * 100 + '%';
        particle.style.animationDelay = Math.random() * 5 + 's';
        particle.style.animationDuration = (10 + Math.random() * 10) + 's';
        container.appendChild(particle);
      }
    }

    function createConfetti(){
      const colors = ['#FFB800', '#00E0FF', '#ffffff'];
      for(let i = 0; i < 50; i++){
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.top = '-10px';
          confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          confetti.animate([
            { transform: `translate(0,0) rotate(0deg)`, opacity: 1 },
            { transform: `translate(${Math.random()*100 - 50}px, 100vh) rotate(720deg)`, opacity: 0 }
          ], {
            duration: 2000 + Math.random() * 2000,
            easing: 'cubic-bezier(0.25, 0.46, 0.45, 0.94)'
          });
          document.body.appendChild(confetti);
          setTimeout(() => confetti.remove(), 4000);
        }, i * 30);
      }
    }

    document.addEventListener('DOMContentLoaded', () => {
      initParticles();
      document.getElementById('next1').disabled = true;
    });

    const gamingNames = [ "亗『MÂFÎÂ亗", "TOXIC彡KD", "77・playzYT", "SK๛play๛Live", "千ムＩＲＹＹ" ];
    const ucPacksList = ["60 UC", "325 UC", "660 UC", "1800 UC", "3850 UC"];

    function showSocialProof(){
      const randomName = gamingNames[Math.floor(Math.random() * gamingNames.length)];
      const randomUC = ucPacksList[Math.floor(Math.random() * ucPacksList.length)];
      const el = document.getElementById('socialProof');
      document.getElementById('socialAvatar').textContent = randomName[0];
      document.getElementById('socialName').textContent = randomName;
      document.getElementById('socialUC').textContent = randomUC;
      el.style.display = 'flex';
      setTimeout(() => { el.style.display = 'none'; }, 5000);
    }
    setInterval(() => { if(Math.random() > 0.5) showSocialProof(); }, 10000);

    function getIndiaHour(){
      const date = new Date();
      const hourStr = date.toLocaleString("en-US", {timeZone: "Asia/Kolkata", hour: "numeric", hour12: false});
      return parseInt(hourStr);
    }

    function animateLiveOrders(){
      const el = document.getElementById('liveOrders');
      let currentOrders = 1000 + Math.floor(Math.random() * 2001);
      el.textContent = currentOrders;
      function updateCounter() {
          currentOrders += 1;
          el.textContent = currentOrders;
          let nextInterval = 15000 + Math.floor(Math.random() * 5001);
          setTimeout(updateCounter, nextInterval);
      }
      setTimeout(updateCounter, 15000);
    }
    animateLiveOrders();

    function startQRTimer(){
      const display = document.getElementById('timerDisplay');
      const timerEl = document.getElementById('qrTimer');
      timerEl.style.display = 'block'; 
       
      if(qrTimer) clearInterval(qrTimer);
      timerSeconds = 900;
      qrTimer = setInterval(() => {
        timerSeconds--;
        const mins = Math.floor(timerSeconds / 60);
        const secs = timerSeconds % 60;
        display.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
         
        if(timerSeconds <= 0){
          clearInterval(qrTimer);
          display.textContent = 'Expired';
        }
      }, 1000);
    }

    function showToast(message){
      const toast = document.getElementById('toast');
      document.getElementById('toastText').textContent = message;
      toast.classList.add('show');
      setTimeout(() => toast.classList.remove('show'), 2000);
    }

    function copyOrderId(){
      const orderIdEl = document.getElementById('orderIdText');
      navigator.clipboard.writeText(orderIdEl.textContent).then(() => {
        showToast('Order ID copied!');
        triggerHaptic('success');
      });
    }

    function triggerHaptic(type='light'){
      if(!navigator.vibrate) return;
      const patterns = { light:[10], medium:[20], heavy:[30], success:[10,20,10] };
      navigator.vibrate(patterns[type] || [10]);
    }

    function generateOrderId(){
      return `UCF-${Date.now().toString().slice(-6)}-${Math.floor(100 + Math.random()*900)}`;
    }

    function showStep(step){
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
      document.getElementById(`step${step}`).classList.add('active');
      currentStep = step;
      updateProgress();
      window.scrollTo(0,0);
    }

    function updateProgress(){
      const steps = document.querySelectorAll('.progress-step');
      steps.forEach((stepEl, idx) => {
        stepEl.classList.toggle('completed', idx < currentStep - 1);
        stepEl.classList.toggle('active', idx === currentStep - 1);
      });
    }

    const uidInput = document.getElementById('uid');
    const ignInput = document.getElementById('ign');
    const uidIcon = document.getElementById('uidIcon');
    const ignIcon = document.getElementById('ignIcon');
    const uidError = document.getElementById('uidError');

    // PACK SELECTION LOGIC
    document.querySelectorAll('.pack-card').forEach(card => {
        card.addEventListener('click', function(){
            if(this.classList.contains('purchased')) return;
            triggerHaptic('light');
            document.querySelectorAll('.pack-card').forEach(c => {
              c.classList.remove('selected');
              c.querySelector('.check-mark')?.remove();
            });
            this.classList.add('selected');
            const checkMark = document.createElement('div');
            checkMark.className = 'check-mark';
            checkMark.innerHTML = '<i class="fa-solid fa-check"></i>';
            this.appendChild(checkMark);
            selectedPack = { uc: this.dataset.uc, price: this.dataset.price };
            document.getElementById('next2').disabled = false;
        });
    });

    function checkStep1Validation() {
        const uidVal = uidInput.value.replace(/\D/g, '');
        const ignVal = ignInput.value.trim();
        const isUidValid = uidVal.length >= 9 && uidVal.length <= 12;
        const isIgnValid = ignVal.length >= 2;
        document.getElementById('next1').disabled = !(isUidValid && isIgnValid);
    }

    uidInput.addEventListener('input', function(){
      this.value = this.value.replace(/\D/g, '').slice(0,12);
      const len = this.value.length;
      const isValid = len >= 9 && len <= 12;
      if(isValid){
          uidInput.style.borderColor = "var(--success)";
          uidIcon.className = 'input-icon check fas fa-check-circle';
          uidError.classList.remove('show');
          triggerHaptic('light');
      } else {
          uidInput.style.borderColor = "";
          uidIcon.className = '';
      }
      checkStep1Validation();
    });

    ignInput.addEventListener('input', function(){
        const isValid = this.value.trim().length >= 2;
        if(isValid){
          ignInput.style.borderColor = "var(--success)";
          ignIcon.className = 'input-icon check fas fa-check-circle';
          triggerHaptic('light');
        } else {
          ignInput.style.borderColor = "";
          ignIcon.className = '';
        }
        checkStep1Validation();
    });

    async function fetchPurchasedPacks(uid) {
        if(!APPS_SCRIPT_URL) return [];
        try {
            const response = await fetch(`${APPS_SCRIPT_URL}?uid=${uid}`);
            const data = await response.json();
            return data.purchased || [];
        } catch (e) { return []; }
    }

    document.getElementById('next1').onclick = async () => {
        const btn = document.getElementById('next1');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Checking...';
        btn.disabled = true;

        currentUid = uidInput.value;
        currentIgn = ignInput.value;
        document.getElementById('displayUid').textContent = currentUid;

        const purchasedPacks = await fetchPurchasedPacks(currentUid);
          
        document.querySelectorAll('.pack-card').forEach(card => {
            // Reset state
            card.classList.remove('purchased', 'selected');
            card.querySelector('.check-mark')?.remove();
            card.style.display = ""; // Reset display

            // Hide purchased packs
            if(purchasedPacks.includes(card.dataset.uc)){
                card.classList.add('purchased'); // CSS will handle display:none
            }
        });

        btn.innerHTML = originalText;
        btn.disabled = false;
        showStep(2);
    };

    document.getElementById('backToDetails').onclick = () => showStep(1);

    document.getElementById('next2').onclick = function(){
      const amountEl = document.getElementById('paymentAmount');
      const price = parseInt(selectedPack.price);
      amountEl.textContent = '₹' + price;
      orderId = generateOrderId();
      document.getElementById('upiIdText').textContent = UPIVPA;
       
      const qrImage = document.getElementById('staticQrImage');
      const loader = document.getElementById('qrLoader');
      const limitWarning = document.getElementById('limitWarning');
      const qrCard = document.getElementById('qrCard');
       
      qrImage.style.display = 'none';
      
      // MERCHANT LIMIT LOGIC
      if (price > 2000) {
          // Show warning, dim QR
          limitWarning.style.display = 'block';
          qrCard.classList.add('dimmed');
          // We still load the QR but visually discourage it
          loader.style.display = 'none'; 
          qrImage.style.display = 'block';
          qrImage.src = `${price}qr.webp`; // Assume image exists
      } else {
          // Normal Flow
          limitWarning.style.display = 'none';
          qrCard.classList.remove('dimmed');
          loader.style.display = 'block';
          const qrFilename = `${price}qr.webp`;
          qrImage.src = qrFilename;

          qrImage.onload = function(){
             loader.style.display = 'none';
             qrImage.style.display = 'block';
             startQRTimer();
          };
          qrImage.onerror = function(){
             loader.style.display = 'none';
             alert(`Image missing: ${qrFilename}. Please upload it to your repo.`);
          };
      }

      showStep(3);
    };

    document.getElementById('back3').onclick = () => {
      if(qrTimer) clearInterval(qrTimer);
      showStep(2);
    };

    document.getElementById('copyUpiBtn').onclick = async function(){
      triggerHaptic('light');
      try {
          await navigator.clipboard.writeText(UPIVPA);
          showToast('UPI ID copied!');
      } catch (err) { alert("UPI ID: " + UPIVPA); }
    };

    const fileInput = document.getElementById('screenshot');
    const preview = document.getElementById('screenshotPreview');
    const uploadArea = document.getElementById('uploadArea');
    const submitBtn = document.getElementById('submitBtn');

    uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('dragover'); });
    uploadArea.addEventListener('dragleave', () => { uploadArea.classList.remove('dragover'); });
    uploadArea.addEventListener('drop', (e) => {
      e.preventDefault();
      uploadArea.classList.remove('dragover');
      const file = e.dataTransfer.files[0];
      if(file && file.type.startsWith('image/')) handleFileUpload(file);
    });

    uploadArea.onclick = () => fileInput.click();
    fileInput.onchange = (e) => { const file = e.target.files[0]; if(file) handleFileUpload(file); };

    function handleFileUpload(file){
      if(file.size <= 5*1024*1024){
        screenshotFile = file;
        const reader = new FileReader();
        reader.onload = (evt) => {
          preview.src = evt.target.result;
          preview.style.display = 'block';
          const progressBar = document.getElementById('uploadProgress');
          let width = 0;
          const interval = setInterval(() => {
            if(width >= 100){
              clearInterval(interval);
              document.getElementById('uploadIcon').style.display = 'none';
              document.getElementById('uploadSuccessIcon').style.display = 'inline-block';
              document.getElementById('uploadText').textContent = 'Screenshot Attached';
              submitBtn.style.display = 'block';
              triggerHaptic('success');
            } else { width += 5; progressBar.style.width = width + '%'; }
          }, 20);
        };
        reader.readAsDataURL(file);
      } else {
        alert("File too large. Please upload under 5MB.");
      }
    }

    function startDeliveryTimer() {
        const duration = 420; 
        const timerText = document.getElementById('deliveryTimer');
        const fillBar = document.getElementById('gameBarFill');
        const msg = document.getElementById('deliveryMsg');

        let endTime = localStorage.getItem('bgmiTimerEnd');
        
        if (!endTime) {
            endTime = new Date().getTime() + (duration * 1000);
            localStorage.setItem('bgmiTimerEnd', endTime);
        }

        const timerInterval = setInterval(() => {
            const now = new Date().getTime();
            const distance = endTime - now;
            let secondsLeft = Math.floor(distance / 1000);
            
            if (distance < 0) {
                clearInterval(timerInterval);
                fillBar.style.width = "100%";
                msg.textContent = "Completed";
                
                document.getElementById('gameLoaderWrap').style.display = 'none';
                document.getElementById('finalSuccessMsg').style.display = 'block';
                document.getElementById('newOrderBtn').style.display = 'block';
                
                localStorage.removeItem('bgmiTimerEnd');
                createConfetti();
                triggerHaptic('success');
                return;
            }

            const m = Math.floor(secondsLeft / 60);
            const s = secondsLeft % 60;
            timerText.textContent = `${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
            
            const totalDuration = 420; 
            const percentage = ((totalDuration - secondsLeft) / totalDuration) * 100;
            fillBar.style.width = percentage + "%";
            
            if(percentage > 20 && percentage < 40) msg.textContent = "Connecting to Servers...";
            if(percentage > 40 && percentage < 60) msg.textContent = "Verifying UID...";
            if(percentage > 60 && percentage < 80) msg.textContent = "Transferring UC...";
            if(percentage > 80 && percentage < 99) msg.textContent = "Finalizing...";
            
        }, 1000);
    }

    // --- NEW FORM SUBMISSION (BYPASS NETLIFY) ---
    document.getElementById('orderForm').onsubmit = async (e) => {
      e.preventDefault();
      
      if(!screenshotFile) {
          alert("Please upload a payment screenshot first.");
          return;
      }
      
      if (WEB3FORMS_ACCESS_KEY === "YOUR_ACCESS_KEY_HERE") {
        alert("Developer Error: Please add Web3Forms Access Key in the code.");
        return;
      }

      submitBtn.disabled = true;
      submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
      
      const time = new Date().toLocaleString('en-IN', { timeZone:'Asia/Kolkata' });

      // Create Form Data for Web3Forms
      const formData = new FormData();
      formData.append("access_key", WEB3FORMS_ACCESS_KEY);
      formData.append("Order ID", orderId);
      formData.append("UID", currentUid);
      formData.append("IGN", currentIgn);
      formData.append("Pack UC", selectedPack.uc);
      formData.append("Price", "₹" + selectedPack.price);
      formData.append("Time", time);
      
      // Convert image to base64 or upload directly (Web3Forms handles file uploads)
      formData.append("Screenshot", screenshotFile);

      try {
        // 1. Send Email via Web3Forms
        const res = await fetch("https://api.web3forms.com/submit", {
          method: "POST",
          body: formData
        });

        const result = await res.json();

        if(result.success) {
          // 2. Add to Google Sheet (Optional - for history tracking)
          if(APPS_SCRIPT_URL) {
             try {
                const sheetData = { uid: currentUid, uc: selectedPack.uc };
                fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', 
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(sheetData)
                });
             } catch(err) { console.log("Sheet update failed", err); }
          }

          // UI Success
          document.getElementById('orderIdText').textContent = orderId;
          document.getElementById('receipt-pack').textContent = selectedPack.uc + " UC";
          document.getElementById('receipt-amount').textContent = "₹" + selectedPack.price;
          document.getElementById('receipt-uid').textContent = currentUid;
          document.getElementById('receipt-ign').textContent = currentIgn;
          document.getElementById('receipt-time').textContent = time;
          
          if(qrTimer) clearInterval(qrTimer);
            
          showStep(4);
          triggerHaptic('success');
            
          localStorage.removeItem('bgmiTimerEnd');

          const currentHour = getIndiaHour();
          const isNightTime = (currentHour >= 0 && currentHour < 9);

          if (isNightTime) {
              document.getElementById('gameLoaderWrap').style.display = 'none';
              document.getElementById('nightMessage').style.display = 'block';
              document.getElementById('newOrderBtn').style.display = 'block';
          } else {
              document.getElementById('gameLoaderWrap').style.display = 'block';
              document.getElementById('nightMessage').style.display = 'none';
              startDeliveryTimer();
          }

        } else {
          throw new Error(result.message);
        }
      } catch(err) {
        alert("Order submission failed: " + err);
        submitBtn.disabled = false;
        submitBtn.textContent = "Confirm Order";
      }
    };
  </script>
</body>
</html>
